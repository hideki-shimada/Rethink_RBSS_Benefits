SELECT T0."zipcode" AS "zipcode",T0."pv_total_kw" AS "pv_total_kw",T0."DateTime" AS "DateTime",T0."e_gen" AS "e_gen",T0."e_use" AS "e_use",T0."e_sell" AS "e_sell",T0."e_buy" AS "e_buy",T0."b_residual" AS "b_residual",T0."b_charge" AS "b_charge",T0."b_discharge" AS "b_discharge",T0.CDNO AS CDNO FROM ( SELECT T0.CDNO AS CDNO,T0."zipcode" AS "zipcode",T0."pv_total_kw" AS "pv_total_kw",T0."DateTime" AS "DateTime",(CASE WHEN ((T0."pv_total_kw" * 1000) < T0."e_gen") THEN NULL ELSE T0."e_gen" END) AS "e_gen",(CASE WHEN (10000 < T0."e_use") THEN NULL ELSE T0."e_use" END) AS "e_use",(CASE WHEN ((T0."pv_total_kw" * 1000) < T0."e_sell") THEN NULL ELSE T0."e_sell" END) AS "e_sell",(CASE WHEN (10000 < T0."e_buy") THEN NULL ELSE T0."e_buy" END) AS "e_buy",T0."b_residual" AS "b_residual",(CASE WHEN (3000 < T0."b_charge") THEN NULL ELSE T0."b_charge" END) AS "b_charge",(CASE WHEN (3000 < T0."b_discharge") THEN NULL ELSE T0."b_discharge" END) AS "b_discharge" FROM "Parts_data" T0) T0,( SELECT T0.CDNO AS CDNO FROM "Parts_data" T0 GROUP BY T0.CDNO HAVING (17184 <= COUNT(*))) T1 WHERE (T0.CDNO = T1.CDNO)