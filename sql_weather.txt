SELECT T1."station_id_temp" AS "station_id_temp",T1."distance_to_station_temp" AS "distance_to_station_temp",T0."zipcode" AS "zipcode" FROM ( SELECT T0."zipcode" AS "zipcode",T0."latitude" AS "latitude",T0."longitude" AS "longitude",T0."elevation" AS "elevation" FROM "M_geo_zipcode" T0) T0 LEFT OUTER JOIN ( SELECT (CASE WHEN (50.0 <= T0."distance") THEN NULL ELSE T0."BlockNo" END) AS "station_id_temp",T0."zipcode" AS "zipcode",T0."distance" AS "distance_to_station_temp" FROM (SELECT T0."BlockNo" AS "BlockNo",T0."BlockName" AS "BlockName",T0."zipcode" AS "zipcode",T0."distance" AS "distance",T0."ROW_NUMBER" AS "ROW_NUMBER" FROM (SELECT T0."BlockNo" AS "BlockNo",T0."BlockName" AS "BlockName",T0."zipcode" AS "zipcode",(6378.1366 * {fn ACOS((({fn SIN(T0."latitude_y1")} * {fn SIN(T0."latitude_y2")}) + (({fn COS(T0."latitude_y1")} * {fn COS(T0."latitude_y2")}) * {fn COS((T0."longitude_x2" - T0."longitude_x1"))})))}) AS "distance",ROW_NUMBER() OVER ( PARTITION BY T0."zipcode" ORDER BY (6378.1366 * {fn ACOS((({fn SIN(T0."latitude_y1")} * {fn SIN(T0."latitude_y2")}) + (({fn COS(T0."latitude_y1")} * {fn COS(T0."latitude_y2")}) * {fn COS((T0."longitude_x2" - T0."longitude_x1"))})))}) ASC) AS "ROW_NUMBER" FROM (SELECT T0."BlockNo" AS "BlockNo",T0."BlockName" AS "BlockName",(CASE WHEN ((T0."latitude" <> 0) OR NOT((T0."latitude" IS NULL))) THEN (T0."latitude" * 0.017453292519943) ELSE T0."latitude" END) AS "latitude_y1",(CASE WHEN ((T0."longitude" <> 0) OR NOT((T0."longitude" IS NULL))) THEN (T0."longitude" * 0.017453292519943) ELSE T0."longitude" END) AS "longitude_x1",T1."zipcode" AS "zipcode",(CASE WHEN ((T1."latitude" <> 0) OR NOT((T1."latitude" IS NULL))) THEN (T1."latitude" * 0.017453292519943) ELSE T1."latitude" END) AS "latitude_y2",(CASE WHEN ((T1."longitude" <> 0) OR NOT((T1."longitude" IS NULL))) THEN (T1."longitude" * 0.017453292519943) ELSE T1."longitude" END) AS "longitude_x2",T0."elevation" AS "elevation_station",T1."elevation" AS "elevation" FROM ADMIN."M_weather_station" T0,"M_geo_zipcode" T1 WHERE NOT((((T0."BlockNo" = 89532) OR (T0."BlockNo" = 47991)) OR (2000 <= T0."elevation"))) AND (T0."is_temp" = 1) AND ({fn ABS((T1."elevation" - T0."elevation"))} <= 166.67)) T0) T0 WHERE (T0."ROW_NUMBER" = 1)) T0) T1 ON (T0."zipcode" = T1."zipcode")